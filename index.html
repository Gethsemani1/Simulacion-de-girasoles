<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Modelo GLTF en A-Frame</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v6.2.0/dist/aframe-extras.min.js"></script>
</head>
<body>
<a-scene background="color: #8ed1fc">
    <a-assets>
        <a-asset-item id="sunflower" src="Assets/scene.gltf"></a-asset-item>
    </a-assets>

    <!-- Cámara en primera persona -->
    <a-entity camera position="0 1.6 35" look-controls></a-entity>

    <!-- Esfera más grande para representar el planeta -->
    <a-entity id="planet" geometry="primitive: sphere; radius: 50;" material="color: #7BC8A4; side: double" position="0 -50 0"></a-entity>

    <!-- Sol -->
    <a-entity id="sun" geometry="primitive: sphere; radius: 2;" material="color: yellow;" position="-30 10 0"></a-entity>

    <!-- Luna -->
    <a-entity id="moon" geometry="primitive: sphere; radius: 2;" material="color: #dddddd;" position="30 -10 0"></a-entity>

    <!-- Girasoles -->
    <a-entity id="girasol1" gltf-model="#sunflower" scale="0.01 0.01 0.01" position="0 0 30" rotation="0 -45 0"></a-entity>
    <a-entity id="girasol2" gltf-model="#sunflower" scale="0.01 0.01 0.01" position="5 0 35" rotation="0 -45 0"></a-entity>
    <a-entity id="girasol3" gltf-model="#sunflower" scale="0.01 0.01 0.01" position="-5 0 35" rotation="0 -45 0"></a-entity>
    <a-entity id="girasol4" gltf-model="#sunflower" scale="0.01 0.01 0.01" position="5 0 25" rotation="0 -45 0"></a-entity>

    <!-- Script para animar la posición del sol y la luna, y rotar los girasoles -->
    <script>
        var sun = document.querySelector('#sun');
        var moon = document.querySelector('#moon');
        var girasol1 = document.querySelector('#girasol1');
        var girasol2 = document.querySelector('#girasol2');
        var girasol3 = document.querySelector('#girasol3');
        var girasol4 = document.querySelector('#girasol4');
        var scene = document.querySelector('a-scene');
        var centerPosition = { x: 0, y: 10, z: 0 };
        var a = 30; // Semieje mayor
        var b = 30; // Semieje menor
        var angle = 0;
        var animating = true;
        var moonAppeared = false;
        var originalBackgroundColor = "#8ed1fc";

        function animateSunAndMoon() {
            angle += 0.01; // Ajusta la velocidad de rotación
            var x = centerPosition.x + a * Math.cos(angle);
            var y = centerPosition.y + b * Math.sin(angle) - 20; // Ajuste para que el sol baje más abajo

            sun.setAttribute('position', x + ' ' + y + ' ' + centerPosition.z);

            // Posicionar la luna en la posición opuesta al sol
            var moonX = centerPosition.x + a * Math.cos(angle + Math.PI);
            var moonY = centerPosition.y + b * Math.sin(angle + Math.PI) - 20;

            moon.setAttribute('position', moonX + ' ' + moonY + ' ' + centerPosition.z);

            if (y >= 0 && !animating) {
                animating = true;
            }

            if (animating) {
                // Ajustar la rotación de los girasoles para seguir al sol
                var rotationAngle = -angle * (180 / Math.PI) - 45;
                girasol1.setAttribute('rotation', '0 ' + rotationAngle + ' 0');
                girasol1.object3D.rotation.y = -angle;
                girasol2.setAttribute('rotation', '0 ' + rotationAngle + ' 0');
                girasol2.object3D.rotation.y = -angle;
                girasol3.setAttribute('rotation', '0 ' + rotationAngle + ' 0');
                girasol3.object3D.rotation.y = -angle;
                girasol4.setAttribute('rotation', '0 ' + rotationAngle + ' 0');
                girasol4.object3D.rotation.y = -angle;

                if (y < 0) {
                    animating = false;
                    resetGirasoles();
                }
            }

            if (y <= -20 && !moonAppeared) {
                moonAppeared = true;
                scene.setAttribute('background', 'color: black');
                moon.setAttribute('visible', 'true');
            }

            if (y > -20 && moonAppeared) {
                moonAppeared = false;
                scene.setAttribute('background', 'color: ' + originalBackgroundColor);
            }

            requestAnimationFrame(animateSunAndMoon);
        }

        function resetGirasoles() {
            girasol1.setAttribute('rotation', '0 -45 0');
            girasol2.setAttribute('rotation', '0 -45 0');
            girasol3.setAttribute('rotation', '0 -45 0');
            girasol4.setAttribute('rotation', '0 -45 0');
        }

        animateSunAndMoon();
    </script>

</a-scene>
</body>
</html>

